/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.2.0
 *
 */
(function(e){jQuery.fn.extend({slimScroll:function(t){var n={width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:false,disableFadeOut:false,railVisible:false,railColor:"#333",railOpacity:.2,railDraggable:true,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:false,wheelStep:20,touchScrollStep:200};var r=e.extend(n,t);this.each(function(){function S(t){if(!n){return}var t=t||window.event;var i=0;if(t.wheelDelta){i=-t.wheelDelta/120}if(t.detail){i=t.detail/3}var s=t.target||t.srcTarget||t.srcElement;if(e(s).closest("."+r.wrapperClass).is(v.parent())){x(i,true)}if(t.preventDefault&&!d){t.preventDefault()}if(!d){t.returnValue=false}}function x(e,t,n){var i=e;var s=v.outerHeight()-w.outerHeight();if(t){i=parseInt(w.css("top"))+e*parseInt(r.wheelStep)/100*w.outerHeight();i=Math.min(Math.max(i,0),s);i=e>0?Math.ceil(i):Math.floor(i);w.css({top:i+"px"})}l=parseInt(w.css("top"))/(v.outerHeight()-w.outerHeight());i=l*(v[0].scrollHeight-v.outerHeight());if(n){i=e;var u=i/v[0].scrollHeight*v.outerHeight();u=Math.min(Math.max(u,0),s);w.css({top:u+"px"})}v.scrollTop(i);v.trigger("slimscrolling",~~i);C();k()}function T(){if(window.addEventListener){this.addEventListener("DOMMouseScroll",S,false);this.addEventListener("mousewheel",S,false)}else{document.attachEvent("onmousewheel",S)}}function N(){f=Math.max(v.outerHeight()/v[0].scrollHeight*v.outerHeight(),p);w.css({height:f+"px"});var e=f==v.outerHeight()?"none":"block";w.css({display:e})}function C(){N();clearTimeout(u);if(l==~~l){d=r.allowPageScroll;if(c!=l){var e=~~l==0?"top":"bottom";v.trigger("slimscroll",e)}}else{d=false}c=l;if(f>=v.outerHeight()){d=true;return}w.stop(true,true).fadeIn("fast");if(r.railVisible){b.stop(true,true).fadeIn("fast")}}function k(){if(!r.alwaysVisible){u=setTimeout(function(){if(!(r.disableFadeOut&&n)&&!i&&!s){w.fadeOut("slow");b.fadeOut("slow")}},1e3)}}function L(e,t,n){e.css({overflow:"",width:"",height:""});e.unbind();t.remove();n.remove();e.unwrap()}var n,i,s,u,a,f,l,c,h="<div></div>",p=30,d=false;var v=e(this);console.log(r.wrapperClass);if(v.parent().hasClass(r.wrapperClass)){var m=v.scrollTop();w=v.parent().find("."+r.barClass);b=v.parent().find("."+r.railClass);N();if(e.isPlainObject(t)){if("height"in t&&t.height=="auto"){v.parent().css("height","auto");v.css("height","auto");var g=v.parent().parent().height();v.parent().css("height",g);v.css("height",g)}if("scrollTo"in t){m=parseInt(r.scrollTo)}else if("scrollBy"in t){m+=parseInt(r.scrollBy)}x(m,false,true)}if(t==="destroy"){L(v,w,b)}return}r.height=r.height=="auto"?v.parent().height():r.height;var y=e(h).addClass(r.wrapperClass).css({position:"relative",overflow:"hidden",width:r.width,height:r.height});v.css({overflow:"hidden",width:r.width,height:r.height});var b=e(h).addClass(r.railClass).css({width:r.size,height:"100%",position:"absolute",top:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.size,background:r.railColor,opacity:r.railOpacity,zIndex:90});var w=e(h).addClass(r.barClass).css({background:r.color,width:r.size,position:"absolute",top:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.size,BorderRadius:r.size,MozBorderRadius:r.size,WebkitBorderRadius:r.size,zIndex:99});var E=r.position=="right"?{right:r.distance}:{left:r.distance};b.css(E);w.css(E);v.wrap(y);v.parent().append(w);v.parent().append(b);if(t==="destroy"){L(v,w,b);return}if(r.railDraggable&&e.ui&&typeof e.ui.draggable=="function"){w.draggable({axis:"y",containment:"parent",start:function(){s=true},stop:function(){s=false;k()},drag:function(t){x(0,e(this).position().top,false)}})}b.hover(function(){C()},function(){k()});w.hover(function(){i=true},function(){i=false});v.hover(function(){n=true;C();k()},function(){n=false;k()});v.bind("touchstart",function(e,t){if(e.originalEvent.touches.length){a=e.originalEvent.touches[0].pageY}});v.bind("touchmove",function(e){e.originalEvent.preventDefault();if(e.originalEvent.touches.length){var t=(a-e.originalEvent.touches[0].pageY)/r.touchScrollStep;x(t,true)}});if(r.start==="bottom"){w.css({top:v.outerHeight()-w.outerHeight()});x(0,true)}else if(r.start!=="top"){x(e(r.start).position().top,null,true);if(!r.alwaysVisible){w.hide()}}T();N()});return this}});jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})})(jQuery)